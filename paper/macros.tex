%% Packages
\usepackage{xcolor}
\usepackage{amsfonts, amsmath, amsthm} %, amssymb
\usepackage{enumitem}
\usepackage{cryptocode}
\usepackage{tabu}
\usepackage{graphics}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\hypersetup{linkcolor = {black}, citecolor = {magenta}, urlcolor = {black}}
\usepackage{amsmath}
\usepackage{pifont}
\usepackage{xspace}
\usepackage{bm}
\usepackage{enumitem}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}
\usepackage{hyperref}
\usepackage{listing}
\usepackage{listings}
\usepackage{cleveref}
\usepackage{todonotes}
\usepackage{pifont}
\setlength{\marginparwidth}{2cm}
\usepackage{titlesec}
\titleformat{\paragraph}[runin]{\bfseries}{\theparagraph}{}{\hspace{-1em}}[.]

%% LaTeX formatting
% \newcommand{\para}[1]{\noindent \textbf{#1.}}

\newcounter{assumption}[section]
\newenvironment{assumption}[2]{
  \refstepcounter{assumption}\par\medskip
  \noindent \textbf{Assumption~\theassumption: #1.} \rmfamily
  #2
}{\medskip}

%% Comments
\ifdefined\publish
  \newcommand{\missing}[1]{}
  \newcommand{\alberto}[1]{}
  \newcommand{\nico}[1]{}
  \newcommand{\philipp}[1]{}
\else
  \newcommand{\missing}[1]{\todo[inline, color=orange!40]{#1}}
  \newcommand{\alberto}[1]{\todo[inline, color=green!40]{\textbf{Alberto:} #1}}
  \newcommand{\nico}[1]{\todo[inline, color=yellow!40]{\textbf{Nico:} #1}}
  \newcommand{\philipp}[1]{\todo[inline, color=teal!20]{\textbf{Philipp:} #1}}
\fi

%% System names
\newcommand{\sysname}{\textit{Arke}\xspace}
\newcommand{\sys}{\sysname}

%% Protocol messages
\newcommand{\tx}{\textsc{WriteTx}\xspace}
\newcommand{\vote}{\textsc{Vote}\xspace}
\newcommand{\cert}{\textsc{Cert}\xspace}
\newcommand{\readtx}{\textsc{ReadTx}\xspace}
\newcommand{\reply}{\textsc{ReadReply}\xspace}

%% Persistent stores
\newcommand{\discoverydb}{\textsf{DiscoveryDb}\xspace}
\newcommand{\lockdb}{\textsf{LockDb}\xspace}

%% Algorithms values
\newcommand{\None}{\textsf{None}\xspace}
\newcommand{\Version}{\textsf{Version}\xspace}
\newcommand{\Epoch}{\textsf{Epoch}\xspace}
\newcommand{\Key}{\textsf{Tag}\xspace}
\newcommand{\Value}{\textsf{Cipher}\xspace}
\newcommand{\Vote}{\textsf{LockVote}\xspace}
\newcommand{\Genesis}{\textsf{GenesisCert}\xspace}
\newcommand{\OldCert}{\textsf{PrevCert}\xspace}
\newcommand{\HighestCert}{\textsf{HighestCert}\xspace}
\newcommand{\HighestVote}{\textsf{HighestVote}\xspace}
\newcommand{\HighestVoteCount}{\textsf{HighestVoteCount}\xspace}

%% Functions
\newcommand{\transaction}[1]{\emph{tx}(#1)\xspace}
\newcommand{\valid}[1]{\emph{valid}(#1)\xspace}
\newcommand{\signtx}[1]{\emph{sign}(#1)\xspace}
\newcommand{\storekey}[1]{\emph{key}(#1)\xspace}
\newcommand{\storevalue}[1]{\emph{value}(#1)\xspace}
\newcommand{\version}[1]{\emph{version}(#1)\xspace}
\newcommand{\epoch}[1]{\emph{epoch}(#1)\xspace}

%% Math notation
\newcommand{\GG}{\mathbb{G}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\pairing}[2]{e\left(#1, #2 \right)}

%% Crypto notations
\newcommand{\key}{\Key}
\newcommand{\val}{\Value}
\newcommand{\str}{\mathsf{str}}
\newcommand{\pk}{\mathsf{pk}}
\newcommand{\pp}{\mathsf{pp}}
\newcommand{\sk}{\mathsf{sk}}
\newcommand{\acc}{\mathsf{acc}}
\newcommand{\sig}{\mathsf{sig}}
\newcommand{\addr}{\mathsf{addr}}
\newcommand{\voprf}{\mathsf{VOPRF}}
\newcommand{\pick}{\xleftarrow{\scriptscriptstyle \$}}
\newcommand{\salt}{\mathsf{salt}}
\newcommand{\kdf}{\mathsf{KDF}}
\newcommand{\mac}{\mathsf{MAC}}
\newcommand{\dleq}{\mathsf{DLEQ}}
\newcommand{\dlog}{\mathsf{DLOG}}
\newcommand{\dkg}{\mathsf{DKG}}
\newcommand{\msg}{\mathsf{msg}}
\newcommand{\adv}{\mathcal{A}}
\newcommand{\bdv}{\mathcal{B}}
\newcommand{\extractor}{\mathcal{E}}


%% BLS
\newcommand{\bls}{\mathsf{BLS}}
\newcommand{\bbls}{\mathsf{BBLS}}
\newcommand{\tbbls}{\mathsf{TBBLS}}
\newcommand{\blsM}{\mathsf{BLS'}}
\newcommand{\bblsM}{\mathsf{BBLS'}}
\newcommand{\tbblsM}{\mathsf{TBBLS'}}
\newcommand{\keygen}{\mathsf{KeyGen}}
\newcommand{\sign}{\mathsf{Sign}}
\newcommand{\verify}{\mathsf{Verify}}
\newcommand{\prove}{\mathsf{Prove}}
\newcommand{\blind}{\mathsf{Blind}}
\newcommand{\unblind}{\mathsf{Unblind}}
\newcommand{\combine}{\mathsf{Combine}}


%% ID-NIKE
\newcommand{\idnike}{\text{ID-NIKE}}
\newcommand{\bextract}{\mathsf{BlindExtract}}
\newcommand{\register}{\mathsf{Register}}
\newcommand{\setup}{\mathsf{Setup}}
\newcommand{\extract}{\mathsf{Extract}}
\newcommand{\sharedkey}{\mathsf{SharedKey}}
\newcommand{\msk}{\mathsf{msk}}
\newcommand{\mpk}{\mathsf{mpk}}
\newcommand{\domain}{\mathsf{dom}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\ID}{\mathsf{ID}}
\newcommand{\bpextract}{\mathsf{BlindPartialExtract}}
\newcommand{\protocol}{\mathcal{KE}}

%AEAD
\newcommand{\enc}{\mathsf{Enc}}
\newcommand{\dec}{\mathsf{Dec}}
\newcommand{\aead}{\mathsf{AEAD}}
\newcommand{\aeadtag}{\mathsf{tag}}

% ZK
\newcommand{\relation}{\mathcal{R}}
\newcommand{\zk}{\mathsf{ZK}}
\newcommand{\witness}{\mathbf{w}}
\newcommand{\instance}{\mathbf{x}}

% Numbers
\newcommand{\one}{\ding{202}\xspace}
\newcommand{\two}{\ding{203}\xspace}
\newcommand{\three}{\ding{204}\xspace}
\newcommand{\four}{\ding{205}\xspace}
\newcommand{\five}{\ding{206}\xspace}
\newcommand{\six}{\ding{207}\xspace}
\newcommand{\seven}{\ding{208}\xspace}
\newcommand{\eight}{\ding{209}\xspace}
\newcommand{\nine}{\ding{210}\xspace}
\newcommand{\ten}{\ding{211}\xspace}
